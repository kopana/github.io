<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Testing | Kount SDK .NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Testing | Kount SDK .NET ">
    <meta name="generator" content="docfx 2.16.0.499">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
              <h1 id="testing">Testing</h1>
              
<h2 id="test-project">Test Project</h2>
<p>Current SDK includes <code>KountRisTest.proj</code> - consists implementation of all integration tests.</p>
<h4 id="test-helper">Test Helper</h4>
<p>Common definitions for all tests (Please refer to <a href="testHelper_class.html">TestHelper class</a> for details).</p>
<div class="NOTE"><h5>Note</h5><p>When using the <code>Kount SDK</code> all credit card information, by default, uses the <code>KHASH</code> encryption method
where the credit card information is irreversibly hashed prior to transmission from the merchant to Kount.</p>
</div>
<pre><code>Output : BIN + 14 alpha-numeric characters.
Example: &quot;123456A12C34E56G7DFG&quot;
</code></pre><p>In the <code>Test project</code> are implemented, both encodings the <code>KHASH</code> and the <code>MASK</code>.</p>
<ul>
<li><p><strong>KHASH</strong></p>
<pre><code class="lang-cs">public static Inquiry CreateInquiry(string cardNumber, out string sid, out string orderNum)
{
  // create inquiry with default settings
  Inquiry inquiry = DefaultInquiry(out sid, out orderNum);

  inquiry.SetCardPayment(cardNumber);

  return inquiry;
}


</code></pre></li>
</ul>
<pre><code>
* **MASK**
```cs
public static Inquiry CreateInquiryMasked(string cardNumber, out string sid, out string orderNum)
{
    // create inquiry with default settings
    Inquiry inquiry = DefaultInquiry(out sid, out orderNum);

    // newly implemented method in SDK
    inquiry.SetCardPaymentMasked(cardNumber);

    return inquiry;
}
</code></pre><div class="NOTE"><h5>Note</h5><p>Diference is only by calling <code>SetCardPayment</code> and <code>SetCardPaymentMasked</code>.</p>
</div>
<h2 id="basic-connectivity-tests">Basic Connectivity Tests</h2>
<h3 id="basic-connectivity-credentials">Basic connectivity credentials</h3>
<p>These are the credentials used for the most basic &quot;does it work?&quot; connection test.<br>This is intended to simulate a new merchant providing their own credentials and verifying 
they can hit the Kount endpoint and receive a valid response.  </p>
<p><strong>Merchant Id :</strong> 999666</p>
<p><strong>Authentication key:</strong> provided by Kount</p>
<h3 id="1-mode-q-call-with-one-cart-item">1. Mode Q call with one cart item.</h3>
<ul>
<li>One rule triggered, </li>
<li>approval status of <code>REVIEW</code> is returned</li>
</ul>
<pre><code class="lang-cs">public void RisQOneItemRequiredFieldsOneRuleReview()
{
    // create inquiry   
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;SPORTING_GOODS&quot;, &quot;SG999999&quot;, &quot;3000 CANDLEPOWER PLASMA FLASHLIGHT&quot;, 
                            2, 68990));
    inquiry.SetCart(cart);

    //get response
    Response response = inquiry.GetResponse();

    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                                            &quot;There are errors in response!&quot;));

    var auto = response.GetAuto();
    Assert.IsTrue(&quot;R&quot;.Equals(auto), &quot;Inquiry failed!  Approval Status is not equal to R&quot;);

    var warnings = response.GetWarnings();
    Assert.IsTrue(warnings.Count == 0, String.Join(Environment.NewLine, warnings, 
                                            &quot;There are warnings in response!&quot;));

    var sid = response.GetSessionId();
    Assert.IsTrue(_sid.Equals(sid), &quot;Inquiry failed! Wrong session ID&quot;);

    var orderNum = response.GetOrderNumber();
    Assert.IsTrue(_orderNum.Equals(orderNum), &quot;Inquiry failed! Wrong order number.&quot;);

    var rulesTrigg = response.GetRulesTriggered();
    Assert.IsTrue(rulesTrigg.Count == 1, &quot;Inquiry failed! RULES TRIGGERED is not 1&quot;);
}
</code></pre><h3 id="2-mode-q-call-with-multiple-items-in-cart">2. Mode Q call with multiple items in cart.</h3>
<ul>
<li>two rules triggered,</li>
<li>an optional fields included,</li>
<li>approval status of <code>DECLINED</code> is returned</li>
</ul>
<pre><code class="lang-cs">public void RisQMultiCartItemsTwoOptionalFieldsTwoRulesDecline()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetUserAgent(TestHelper.UAGT);
    inquiry.SetTotal(123456789); 

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                            10, 1000));
    cart.Add(new CartItem(&quot;cart item 1 type&quot;, &quot;cart item 1&quot;, &quot;cart item 1 description&quot;, 
                            11, 1001));
    cart.Add(new CartItem(&quot;cart item 2 type&quot;, &quot;cart item 2&quot;, &quot;cart item 2 description&quot;, 
                            12, 1002));
    inquiry.SetCart(cart);

    //SET Customer User-Agent HTTP header UAGT
    Response response = inquiry.GetResponse();
    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                                    &quot;There are errors in response!&quot;));

    var auto = response.GetAuto();
    Assert.IsTrue(&quot;D&quot;.Equals(auto), &quot;Inquiry failed! Approval Status is not equal to D&quot;);

    var warnings = response.GetWarnings();
    Assert.IsTrue(warnings.Count == 0, String.Join(Environment.NewLine, warnings, 
                                    &quot;There are warnings in response!&quot;));

    var rulesTrigg = response.GetRulesTriggered();
    Assert.IsTrue(rulesTrigg.Count == 2, &quot;Inquiry failed! RULES TRIGGERED is not 2&quot;);
}
</code></pre><h3 id="3-ris-mode-q-with-user-defined-fields">3. Ris mode Q with user defined fields.</h3>
<ul>
<li>approval status of <code>REVIEW</code> is returned</li>
</ul>
<pre><code class="lang-cs">public void RisQWithUserDefinedFields()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetUserDefinedField(&quot;ARBITRARY_ALPHANUM_UDF&quot;, &quot;alphanumeric trigger value&quot;);
    inquiry.SetUserDefinedField(&quot;ARBITRARY_NUMERIC_UDF&quot;, &quot;777&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                            10, 1000));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();

    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                                        &quot;There are errors in response!&quot;));

    var auto = response.GetAuto();
    Assert.IsTrue(&quot;R&quot;.Equals(auto), &quot;Inquiry failed!  Approval Status is not equal to R&quot;);

    var warnings = response.GetWarnings();
    Assert.IsTrue(warnings.Count == 0, String.Join(Environment.NewLine, warnings, 
                                        &quot;There are warnings in response!&quot;));

    var rulesTrigg = response.GetRulesTriggered();
    Assert.IsTrue(rulesTrigg != null &amp;&amp; rulesTrigg.Count != 0, 
                        &quot;Inquiry failed! There no RULES_TRIGGERED.&quot;);

    List&lt;string&gt; listResponce = new List&lt;string&gt;(Regex.Split(response.ToString(), 
                        &quot;[\r\n]+&quot;));
    var filteredList = listResponce.FindAll(i =&gt; i.Contains(&quot;RULE_DESCRIPTION&quot;));
    Assert.IsTrue(rulesTrigg.Count == filteredList.Count, 
                        &quot;Inquiry failed! Count of RULES_TRIGGERED is wrong!&quot;);

    var r1 = filteredList.Find(r =&gt; 
                        r.Contains(&quot;review if ARBITRARY_ALPHANUM_UDF contains \&quot;trigger\&quot;&quot;));
    var r2 = filteredList.Find(r =&gt; r.Contains(&quot;review if ARBITRARY_NUMERIC_UDF == 777&quot;));
    Assert.IsTrue(r1 != null &amp;&amp; r2 != null, 
                        &quot;Inquiry failed! The content of triggered rules are wrong!&quot;);
}
</code></pre><h3 id="4-invalid-value-for-a-required-field-is-sent">4. Invalid value for a required field is sent,</h3>
<ul>
<li>hard error returned</li>
</ul>
<pre><code class="lang-cs">public void RisQHardErrorExpected()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetParameter(&quot;PTOK&quot;, Khash.HashPaymentToken(&quot;BADPTOK&quot;));
    inquiry.SetGender(&#39;M&#39;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                            10, 1000));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();

    var mode = response.GetMode();
    Assert.IsTrue(&quot;E&quot;.Equals(mode), $&quot;Update failed! Wrong response mode {mode}.&quot;);

    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 1, &quot;Wrong responce expected error_num: 332, ERROR_COUNT=1&quot;);

    var err0 = errors[0];
    string errCode = err0.Substring(0, 3);
    Assert.IsTrue(err0.Contains(&quot;332 BAD_CARD Cause: [PTOK invalid format], Field: [PTOK], 
                                 Value: [hidden]&quot;), $&quot;Wrong error value: {err0}, expected 332&quot;);
}
</code></pre><h3 id="5-warning-reported-but-status-of-approved-returned">5. Warning reported but status of <code>APPROVED</code> returned.</h3>
<ul>
<li><p>two warnings are returned.</p>
<ul>
<li><code>[UDF_DOESNOTEXIST=&gt;throw a warning please!]</code></li>
<li><p><code>[The label [UDF_DOESNOTEXIST] is not defined for merchant ID [999666].]</code></p>
<pre><code class="lang-cs">public void RisQWarningApproved()
{
Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

inquiry.SetTotal(1000);
inquiry.SetUserDefinedField(&quot;UDF_DOESNOTEXIST&quot;, &quot;throw a warning please!&quot;);

// set CART with one item
var cart = new ArrayList();
cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                      10, 1234));
inquiry.SetCart(cart);

Response response = inquiry.GetResponse();

var sessID = response.GetSessionId();
var tranID = response.GetTransactionId();
var ordNum = response.GetOrderNumber();

var errors = response.GetErrors();
Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                                  &quot;There are errors in response!&quot;));

var auto = response.GetAuto();
Assert.IsTrue(&quot;A&quot;.Equals(auto), 
         $&quot;Inquiry failed! Approval status {auto} is not equal to A&quot;);

var warnings = response.GetWarnings();
Assert.IsTrue(warnings.Count == 2, 
         $&quot;TranID: {tranID} - Wrong number of warnings: {warnings.Count}, expected 2.&quot;);

List&lt;string&gt; listResponce = new List&lt;string&gt;(Regex.Split(response.ToString(), &quot;[\r\n]+&quot;));
var filteredList = listResponce.FindAll(i =&gt; i.Contains(&quot;WARNING_&quot;));
var w1 = filteredList.Find(r =&gt; r.Contains(&quot;[UDF_DOESNOTEXIST=&gt;throw a warning please!]&quot;));
var w2 = filteredList.Find(r =&gt; 
  r.Contains(&quot;[The label [UDF_DOESNOTEXIST] is not defined for merchant ID [999666].]&quot;));

Assert.IsTrue(w1 != null, $&quot;Inquiry failed! The value {warnings[0]} of warning is wrong!&quot;);
Assert.IsTrue(w2 != null, $&quot;Inquiry failed! The value {warnings[1]} of warning is wrong!&quot;);
}


</code></pre></li>
</ul>
</li>
</ul>
<pre><code>### 6. One hard error triggered, one warning triggered.
* one error
    * `332 BAD_CARD Cause: [PTOK invalid format], Field: [PTOK], Value: [hidden]`
* two warnings are returned.
    * `[UDF_DOESNOTEXIST=&gt;throw a warning please!]`
    * `[The label [UDF_DOESNOTEXIST] is not defined for merchant ID [999666].]`

```cs
public void RisQHardSoftErrorsExpected()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetParameter(&quot;PTOK&quot;, Khash.HashPaymentToken(&quot;BADPTOK&quot;));
    inquiry.SetUserDefinedField(&quot;UDF_DOESNOTEXIST&quot;, &quot;throw a warning please!&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                    10, 1000));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse(false);

    var mode = response.GetMode();
    Assert.IsTrue(&quot;E&quot;.Equals(mode), $&quot;Update failed! Wrong response mode {mode}.&quot;);

    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 1, 
                    &quot;Wrong responce expected error_num: 332, ERROR_COUNT=1&quot;);

    var err0 = errors[0];
    Assert.IsTrue(err0.Contains(&quot;332 BAD_CARD Cause: [PTOK invalid format], 
              Field: [PTOK], Value: [hidden]&quot;), $&quot;Wrong error content: {err0}, expected 332.&quot;);

    var warnings = response.GetWarnings();
    Assert.IsTrue(warnings.Count == 2, 
              $&quot;Wrong number of warnings: {warnings.Count}, expected 2.&quot;);

    List&lt;string&gt; listResponce = new List&lt;string&gt;(Regex.Split(response.ToString(), &quot;[\r\n]+&quot;));
    var filteredList = listResponce.FindAll(i =&gt; i.Contains(&quot;WARNING_&quot;));
    var w1 = filteredList.Find(r =&gt; r.Contains(&quot;[UDF_DOESNOTEXIST=&gt;throw a warning please!]&quot;));
    var w2 = filteredList.Find(r =&gt; 
        r.Contains(&quot;[The label [UDF_DOESNOTEXIST] is not defined for merchant ID [999666].]&quot;));

    Assert.IsTrue(w1 != null, $&quot;Inquiry failed! The value {warnings[0]} of warning is wrong!&quot;);
    Assert.IsTrue(w2 != null, $&quot;Inquiry failed! The value {warnings[1]} of warning is wrong!&quot;);
}
</code></pre><h3 id="7-no-kount-complete-rules-triggered">7. No Kount Complete rules triggered,</h3>
<ul>
<li>two Kount Central <code>rules</code> triggered,</li>
<li><p>Kount Central status of <code>REVIEW</code></p>
<pre><code>          KC_TRIGGERED_COUNT : 2
          KC_WARNING_COUNT   : 0
          KC_DECISION        : &quot;R&quot;
          KC_EVENT_1_CODE    : &quot;billingToShippingAddressReview&quot;
          KC_EVENT_1_DECISION: &quot;R&quot;
          KC_EVENT_2_CODE    : &quot;orderTotalReview&quot;
          KC_EVENT_2_DECISION: &quot;R&quot;
</code></pre></li>
</ul>
<pre><code class="lang-cs">public void RisWTwoKCRulesReview()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetMode(&#39;W&#39;);
    inquiry.SetTotal(10001);
    inquiry.SetKountCentralCustomerId(&quot;KCentralCustomerOne&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                    10, 1234));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();

    var sessID = response.GetSessionId();
    var tranID = response.GetTransactionId();
    var ordNum = response.GetOrderNumber();

    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                &quot;There are errors in response!&quot;));

    var mode = response.GetMode();
    Assert.IsTrue(&quot;W&quot;.Equals(mode), $&quot;Update failed! Wrong response mode {mode}.&quot;);

    var warnings = response.GetWarnings();
    Assert.IsTrue(warnings.Count == 0, String.Join(Environment.NewLine, warnings, 
                &quot;There are warnings in response!&quot;));

    /*
        &quot;KC_TRIGGERED_COUNT&quot;: 2
        &quot;KC_WARNING_COUNT&quot;: 0
        &quot;KC_DECISION&quot;: &quot;R&quot;
        &quot;KC_EVENT_1_CODE&quot;: &quot;billingToShippingAddressReview&quot;
        &quot;KC_EVENT_1_DECISION&quot;: &quot;R&quot;
        &quot;KC_EVENT_2_CODE&quot;: &quot;orderTotalReview&quot;
        &quot;KC_EVENT_2_DECISION&quot;: &quot;R&quot;
    */
    var kcCustId = response.GetKountCentralCustomerId();
    var kcDecision = response.GetKountCentralDecision();
    Assert.IsTrue(&quot;R&quot;.Equals(kcDecision), 
                    $&quot;Inquiry failed! KC Decision {kcDecision} is not equal to R&quot;);

    var kcErrs = response.GetKountCentralErrors();
    Assert.IsTrue(kcErrs.Count == 0, 
                    $&quot;Inquiry failed! KC Errors: {String.Join(Environment.NewLine, kcErrs)}&quot;);

    var kcWarn = response.GetKountCentralWarnings();
    Assert.IsTrue(kcWarn.Count == 0, 
                    $&quot;Inquiry failed! KC Warnings: {String.Join(Environment.NewLine, kcWarn)}&quot;);

    var kcEvents = response.GetKountCentralThresholdEvents();
    Assert.IsTrue(kcEvents.Count == 2, $&quot;Inquiry failed! KC Events: 
                                                   {kcEvents.Count} are not 2.&quot;);

    Assert.IsTrue(&quot;R&quot;.Equals(kcEvents[0].Decision), $&quot;Inquiry failed! Wrong decisions d1 = 
      {kcEvents[0].Decision}, d2 = {kcEvents[1].Decision} by Kount Central ThresholdEvents.&quot;);
    Assert.IsTrue(&quot;R&quot;.Equals(kcEvents[1].Decision), $&quot;Inquiry failed! Wrong decisions d1 = 
      {kcEvents[0].Decision}, d2 = {kcEvents[1].Decision} by Kount Central ThresholdEvents.&quot;);

    var code1 = kcEvents[0].Code;
    var code2 = kcEvents[1].Code;
    Assert.IsTrue(&quot;billingToShippingAddressReview&quot;.Equals(code1) 
            || &quot;billingToShippingAddressReview&quot;.Equals(code2),
      $&quot;Inquiry failed! Wrong  KC codes: {code1}, {code2} expected billingToShippingAddressReview.&quot;);

    Assert.IsTrue(&quot;orderTotalReview&quot;.Equals(code1) || &quot;orderTotalReview&quot;.Equals(code2),
                $&quot;Inquiry failed! Wrong  KC codes: {code1}, {code2} expected orderTotalReview.&quot;);
}
</code></pre><h3 id="8-mode-j-call-one-threshold-triggered">8. Mode J call one threshold triggered.</h3>
<ul>
<li><p>mode <code>J</code> is returned.</p>
<pre><code>        KC_TRIGGERED_COUNT : 1
        KC_WARNING_COUNT   : 0
        KC_DECISION        : &quot;D&quot;
        KC_EVENT_1_CODE    : &quot;orderTotalDecline&quot;
        KC_EVENT_1_DECISION: &quot;D&quot;
</code></pre></li>
</ul>
<pre><code class="lang-cs">public void RisJOneKountCentralRuleDecline()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetMode(&#39;J&#39;);
    inquiry.SetTotal(1000);
    inquiry.SetKountCentralCustomerId(&quot;KCentralCustomerDeclineMe&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                    10, 1234));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();
    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                        &quot;There are errors in response!&quot;));

    var mode = response.GetMode();
    Assert.IsTrue(&quot;J&quot;.Equals(mode), $&quot;Update failed! Wrong response mode {mode}.&quot;);

    var warnings = response.GetWarnings();
    Assert.IsTrue(warnings.Count == 0, String.Join(Environment.NewLine, warnings, 
                        &quot;There are warnings in response!&quot;));
    /*
      &quot;KC_TRIGGERED_COUNT&quot;: 1,
      &quot;KC_WARNING_COUNT&quot;: 0,
      &quot;KC_DECISION&quot;: &quot;D&quot;,
      &quot;KC_EVENT_1_CODE&quot;: &quot;orderTotalDecline&quot;,
      &quot;KC_EVENT_1_DECISION&quot;: &quot;D&quot;
     */
    var kcCustId = response.GetKountCentralCustomerId();
    var kcDecision = response.GetKountCentralDecision();
    Assert.IsTrue(&quot;D&quot;.Equals(kcDecision), 
            $&quot;Inquiry failed! KC Decision {kcDecision} is not equal to D&quot;);

    var kcErrs = response.GetKountCentralErrors();
    Assert.IsTrue(kcErrs.Count == 0, 
            $&quot;Inquiry failed! KC Errors: {String.Join(Environment.NewLine, kcErrs)}&quot;);

    var kcWarn = response.GetKountCentralWarnings();
    Assert.IsTrue(kcWarn.Count == 0, 
            $&quot;Inquiry failed! KC Warnings: {String.Join(Environment.NewLine, kcWarn)}&quot;);

    var kcEvents = response.GetKountCentralThresholdEvents();
    Assert.IsTrue(kcEvents.Count == 1, $&quot;Inquiry failed! KC Events: {kcEvents.Count} are not 1.&quot;);
    Assert.IsTrue(&quot;D&quot;.Equals(kcEvents[0].Decision), 
            $&quot;Inquiry failed! Wrong decisions d1 = 
                    {kcEvents[0].Decision} by Kount Central ThresholdEvents.&quot;);

    var code1 = kcEvents[0].Code;
    Assert.IsTrue(&quot;orderTotalDecline&quot;.Equals(code1), 
            $&quot;Inquiry failed! Wrong  KC codes: {code1}, expected orderTotalDecline.&quot;);
}
</code></pre><h3 id="9-mode-u-call-submits-updated-values">9. Mode U call submits updated values.</h3>
<ul>
<li>return values do not include the re-evalued transaction results,</li>
</ul>
<pre><code class="lang-cs">public void ModeUAfterModeQ()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                    10, 1234));
    inquiry.SetCart(cart);

    // get response
    Response response = inquiry.GetResponse();

    // optional getter
    var errors = response.GetErrors();
    if (errors.Count &gt; 0)
    {
        Assert.IsTrue(false, String.Join(Environment.NewLine, errors));
        return;
    }

    var sessID = response.GetSessionId();
    var tranID = response.GetTransactionId();
    var ordNum = response.GetOrderNumber();

    // create Update
    Update update = new Update();
    update.SetMode(&#39;U&#39;);
    update.SetVersion(&quot;0695&quot;);
    update.SetMerchantId(TestHelper.TEST_MERCHANT_ID);
    update.SetApiKey(TestHelper.TEST_API_KEY);
    update.SetSessionId(sessID);
    update.SetTransactionId(tranID);
    update.SetOrderNumber(ordNum);
    update.SetParameter(&quot;PTOK&quot;, Khash.HashPaymentToken(&quot;5386460135176807&quot;));
    update.SetPaymentTokenLast4(&quot;6807&quot;);
    update.SetMack(&#39;Y&#39;);
    update.SetAuth(&#39;A&#39;);
    update.SetAvst(&#39;M&#39;);
    update.SetAvsz(&#39;M&#39;);
    update.SetCvvr(&#39;M&#39;);

    response = update.GetResponse();
    errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, &quot;There are errors in response!&quot;));

    var mode = response.GetMode();
    Assert.IsTrue(&quot;U&quot;.Equals(mode), $&quot;Update failed! Wrong response mode {mode}.&quot;);

    Assert.IsTrue(sessID.Equals(response.GetSessionId()), 
                                    $&quot;Update failed! Wrong session ID  {sessID}.&quot;);

    Assert.IsTrue(tranID.Equals(response.GetTransactionId()), 
                                    $&quot;Update failed! Wrong Transaction Id  {tranID}.&quot;);

    var ordU = response.GetOrderNumber(); // orderNum is null

    var auto = response.GetAuto();
    Assert.IsTrue(auto == null, $&quot;Inquiry failed! Approval status {auto} is not null&quot;);

    var scor = response.GetScore();
    Assert.IsTrue(scor == null, $&quot;Inquiry failed! Score {scor} is not null&quot;);

    var geox = response.GetGeox();
    Assert.IsTrue(geox == null, $&quot;Inquiry failed! GEOX {geox} is not null&quot;);
}
</code></pre><h3 id="10--mode-x-call-submits-updated-values">10.  Mode <code>X</code> call submits updated values.</h3>
<ul>
<li>return values include all mode <code>Q</code> values, re-evaluated for updated data,</li>
<li>To test, submit a default value mode <code>Q</code> transaction, capture <code>TRAN</code>, <code>SESS</code>, <code>ORDR</code> values, and then use those to submit a mode <code>X</code></li>
</ul>
<pre><code class="lang-cs">public void ModeXAfterModeQ()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, 
                            &quot;cart item 0 description&quot;, 10, 1234));
    inquiry.SetCart(cart);

    // get response
    Response response = inquiry.GetResponse();

    // optional getter
    var errors = response.GetErrors();
    if (errors.Count &gt; 0)
    {
        Assert.IsTrue(false, String.Join(Environment.NewLine, errors));
        return;
    }

    var sessID = response.GetSessionId();
    var tranID = response.GetTransactionId();
    var ordNum = response.GetOrderNumber();
    // create update
    Update update = new Update();
    update.SetMode(&#39;X&#39;);
    update.SetVersion(&quot;0695&quot;);

    update.SetMerchantId(TestHelper.TEST_MERCHANT_ID);
    update.SetApiKey(TestHelper.TEST_API_KEY);

    update.SetSessionId(sessID);
    update.SetTransactionId(tranID);
    update.SetOrderNumber(ordNum);
    update.SetPaymentTokenLast4(&quot;6807&quot;);
    update.SetMack(&#39;Y&#39;);
    update.SetAuth(&#39;A&#39;);
    update.SetAvst(&#39;M&#39;);
    update.SetAvsz(&#39;M&#39;);
    update.SetCvvr(&#39;M&#39;);

    response = update.GetResponse();
    errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                                    &quot;There are errors in response!&quot;));

    var mode = response.GetMode();
    Assert.IsTrue(&quot;X&quot;.Equals(mode), $&quot;Update failed! Wrong response mode  {mode}.&quot;);

    var sID = response.GetSessionId();
    Assert.IsTrue(sessID.Equals(sID), $&quot;Update failed! Wrong session ID  {sID}.&quot;);

    var tId = response.GetTransactionId();
    Assert.IsTrue(tranID.Equals(tId), $&quot;Update failed! Wrong Transaction Id  {tranID}.&quot;);

    var ordU = response.GetOrderNumber();
    Assert.IsTrue(ordNum.Equals(ordU), $&quot;Update failed! Wrong Order Number {ordNum}.&quot;);

    var auto = response.GetAuto();
    Assert.IsTrue(auto != null, $&quot;Update failed! AUTO not presented in response.&quot;);

    var scor = response.GetScore();
    Assert.IsTrue(scor != null, $&quot;Update failed! SCOR not presented in response.&quot;);

    var geox = response.GetGeox();
    Assert.IsTrue(geox != null, $&quot;Update failed! GEOX not presented in response.&quot;);
}
</code></pre><h3 id="11-approval-status-of-approved-returned">11. Approval status of <code>APPROVED</code> returned.</h3>
<ul>
<li>mode <code>P</code> is returned.</li>
</ul>
<pre><code class="lang-cs">public void ModeP()
{
    Inquiry inquiry = TestHelper.CreateInquiry(PTOK, out _sid, out _orderNum);

    inquiry.SetAnid(&quot;2085551212&quot;);
    inquiry.SetMode(&#39;P&#39;);
    inquiry.SetTotal(1000);
    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, 
                            &quot;cart item 0 description&quot;, 10, 1234));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();
    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                        &quot;There are errors in response!&quot;));

    var mode = response.GetMode();
    Assert.IsTrue(&quot;P&quot;.Equals(mode), $&quot;Update failed! Wrong response mode {mode}.&quot;);

    var auto = response.GetAuto();
    Assert.IsTrue(&quot;A&quot;.Equals(auto), 
            $&quot;Inquiry failed! Approval status {auto} is wrong, expected &#39;A&#39;.&quot;);
}
</code></pre><h2 id="predictive-response-tests">Predictive Response Tests</h2>
<p>Predictive Response is a mechanism that can be used by Kount merchants to submit test requests and
receive back predictable RIS responses. This means that a merchant, in order to test RIS, can generate
a particular request that is designed to provide one or more specific RIS responses and/or errors. The
predictive response inquiries are not actual RIS inquiries, which means the data will never be submitted
to the database and will not be displayed in the Agent Web Console.</p>
<p>The primary reason for having Predictive Response functionality is to diagnose error responses being
received from RIS. For instance, a merchant may receive a large number of different error codes after
submitting a RIS request. Most of these errors can be reliably reproduced by passing malformed, missing,
or additional data in the RIS request. However, some of the errors are extremely difficult or even
impossible to reproduce through simple means. There is no way to re-create these errors in a systematic
or predictable fashion using RIS request input, rules, and/or Data Collector.</p>
<p><strong>Merchant Id :</strong> 999667</p>
<p><strong>Authentication key:</strong> provided by Kount</p>
<h3 id="1-expected-score42-and-expected-decision--r">1. Expected <code>Score=42</code> and expected <code>Decision = R</code></h3>
<ul>
<li>Input to predictive response, <code>UDF[~K!_SCOR] = 42</code><ul>
<li>Produces <code>RIS</code> output, <code>SCOR=42</code></li>
</ul>
</li>
<li>Input to predictive response, <code>UDF[~K!_AUTO] = R</code><ul>
<li>Produces <code>RIS</code> output, <code>AUTO=R</code></li>
</ul>
</li>
<li>Email input will need to be, <code>EMAL=predictive @kount.com</code></li>
</ul>
<pre><code class="lang-cs">public void PredictiveResponseScore42AutoR()
{
    Inquiry inquiry = CreateInquiry();

    inquiry.SetUserDefinedField(&quot;~K!_SCOR&quot;, &quot;42&quot;);
    inquiry.SetUserDefinedField(&quot;~K!_AUTO&quot;, &quot;R&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                10, 1000));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();
    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                    &quot;There are errors in response!&quot;));

    var score = response.GetScore();
    Assert.IsTrue(&quot;42&quot;.Equals(score), &quot;Inquiry failed!   Expected Score=42.&quot;);

    var auto = response.GetAuto();
    Assert.IsTrue(&quot;R&quot;.Equals(auto), &quot;Inquiry failed!  Expected Decision=R&quot;);
}
</code></pre><h3 id="2-expected-score42-and-expected-decision--d">2. Expected <code>Score=42</code> and expected <code>Decision = D</code></h3>
<ul>
<li>Input to predictive response, <code>UDF[~K!_SCOR] = 42</code><ul>
<li>Produces <code>RIS</code> output, <code>SCOR=42</code> </li>
</ul>
</li>
<li>Input to predictive response, <code>UDF[~K!_AUTO] = D</code><ul>
<li>Produces <code>RIS</code> output, <code>AUTO=D</code></li>
</ul>
</li>
<li>Input to predictive response, <code>UDF[~K!_GEOX]=NG</code> </li>
<li>Email input will need to be, <code>EMAL=predictive @kount.com</code></li>
</ul>
<pre><code class="lang-cs">public void PredictiveResponseScore42AutoD()
{
    Inquiry inquiry = CreateInquiry();

    inquiry.SetUserDefinedField(&quot;~K!_SCOR&quot;, &quot;42&quot;);
    inquiry.SetUserDefinedField(&quot;~K!_AUTO&quot;, &quot;D&quot;);
    inquiry.SetUserDefinedField(&quot;~K!_GEOX&quot;, &quot;NG&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                10, 1000));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();
    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 0, String.Join(Environment.NewLine, errors, 
                    &quot;There are errors in response!&quot;));

    var score = response.GetScore();
    Assert.IsTrue(&quot;42&quot;.Equals(score), &quot;Inquiry failed!   Expected Score=42.&quot;);

    var auto = response.GetAuto();
    Assert.IsTrue(&quot;D&quot;.Equals(auto), &quot;Inquiry failed!  Expected Decision=D&quot;);

    var geox = response.GetGeox();
    Assert.IsTrue(&quot;NG&quot;.Equals(geox), &quot;Inquiry failed!  Expected GEOX=NG&quot;);
}
</code></pre><h3 id="3-expected-score18">3. Expected Score=18</h3>
<ul>
<li>Input to predictive response, <code>UDF[~K!_SCOR] = 18</code><ul>
<li>Produces <code>RIS</code> output, <code>MODE=E</code> and <code>ERRO=601</code></li>
</ul>
</li>
<li>Email input will need to be, <code>EMAL=predictive @kount.com</code></li>
</ul>
<pre><code class="lang-cs">public void PredictiveResponseScore18ModeE()
{
    Inquiry inquiry = CreateInquiry();

    inquiry.SetUserDefinedField(&quot;~K!_SCOR&quot;, &quot;18&quot;);
    inquiry.SetUserDefinedField(&quot;~K!_AUTO&quot;, &quot;E&quot;);
    inquiry.SetUserDefinedField(&quot;~K!_ERRO&quot;, &quot;601&quot;);

    // set CART with one item
    var cart = new ArrayList();
    cart.Add(new CartItem(&quot;cart item 0 type&quot;, &quot;cart item 0&quot;, &quot;cart item 0 description&quot;, 
                    10, 1000));
    inquiry.SetCart(cart);

    Response response = inquiry.GetResponse();
    // optional getter
    var errors = response.GetErrors();
    Assert.IsTrue(errors.Count == 1, String.Join(Environment.NewLine, errors, 
                                    &quot;Errors are not equals to 1!&quot;));

    var mode = response.GetMode();
    Assert.IsTrue(&quot;E&quot;.Equals(mode), &quot;Inquiry failed!  Expected Mode=E&quot;);

    var err0 = errors[0];
    string errCode = err0.Substring(0, 3);
    Assert.IsTrue(&quot;601&quot;.Equals(errCode), &quot;Inquiry failed!  Expected ERRO=601&quot;);
}
</code></pre><h2 id="custom-merchant-id-and-api-key">Custom Merchant ID and API Key</h2>
<p>One integration test allows a Developer to set customer(new merchant) credentials in config project file. 
This test is geared toward ensuring the customer&#39;s credentials are valid, but doesn&#39;t depend on a RuleSet being in a specific state.</p>

            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2017 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
